<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-red-team-operations/penetration-testing/network/advanced-hash-cracking" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Advanced Hash Cracking | Portfolio</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.harisqazi.com/img/blog_image.cleaned.jpeg"><meta data-rh="true" name="twitter:image" content="https://www.harisqazi.com/img/blog_image.cleaned.jpeg"><meta data-rh="true" property="og:url" content="https://www.harisqazi.com/red-team-operations/penetration-testing/network/advanced-hash-cracking"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Advanced Hash Cracking | Portfolio"><meta data-rh="true" name="description" content="Advanced techniques for cracking hashes"><meta data-rh="true" property="og:description" content="Advanced techniques for cracking hashes"><link data-rh="true" rel="icon" href="/img/HQ-Logo-Dark.png"><link data-rh="true" rel="canonical" href="https://www.harisqazi.com/red-team-operations/penetration-testing/network/advanced-hash-cracking"><link data-rh="true" rel="alternate" href="https://www.harisqazi.com/red-team-operations/penetration-testing/network/advanced-hash-cracking" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.harisqazi.com/red-team-operations/penetration-testing/network/advanced-hash-cracking" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Portfolio RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Portfolio Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Portfolio JSON Feed"><link rel="stylesheet" href="/assets/css/styles.03fad3ea.css">
<script src="/assets/js/runtime~main.54c31341.js" defer="defer"></script>
<script src="/assets/js/main.76b4cc88.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.harisqazi.com/" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/HQ-Logo-Light.png" alt="Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/HQ-Logo-Dark.png" alt="Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Haris Qazi</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Portfolio</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/harisqazi1/portfolio" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite" aria-pressed="true"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/privacy">Privacy Policy</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/configurations">Configurations</a><button aria-label="Expand sidebar category &#x27;Configurations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/operations-security-opsec">Operations Security (OPSEC)</a><button aria-label="Expand sidebar category &#x27;Operations Security (OPSEC)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/open-source-intelligence-osint">Open-Source Intelligence (OSINT)</a><button aria-label="Expand sidebar category &#x27;Open-Source Intelligence (OSINT)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/category/red-team-operations">Red Team Operations</a><button aria-label="Collapse sidebar category &#x27;Red Team Operations&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/category/penetration-testing">Penetration Testing</a><button aria-label="Collapse sidebar category &#x27;Penetration Testing&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/category/physical">Physical</a><button aria-label="Expand sidebar category &#x27;Physical&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/category/network">Network</a><button aria-label="Collapse sidebar category &#x27;Network&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/red-team-operations/penetration-testing/network/advanced-hash-cracking">Advanced Hash Cracking</a></li></ul></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/red-team-operations"><span itemprop="name">Red Team Operations</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/penetration-testing"><span itemprop="name">Penetration Testing</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/network"><span itemprop="name">Network</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Advanced Hash Cracking</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Advanced Hash Cracking</h1></header>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>I mention commands using hashcat in this post. John the Ripper does have <a href="https://github.com/openwall/john/blob/bleeding-jumbo/doc/RULES" target="_blank" rel="noopener noreferrer">rule</a> and <a href="https://github.com/openwall/john/blob/bleeding-jumbo/doc/MASK" target="_blank" rel="noopener noreferrer">mask</a> attacks as well. Their syntax might be a bit different, but the idea behind these are the same as hashcat. JtR even has the <a href="https://github.com/openwall/john/blob/bleeding-jumbo/doc/PRINCE" target="_blank" rel="noopener noreferrer">&quot;Purple Rain Attack&quot;</a> mentioned below.</p></div></div>
<p>I have been doing hash cracking for a couple of years now, and have heard the terms rules and masks thrown around here and there. This blog post will be my journey through learning what rules and masks are, as well as showing some use cases that might not be apparent at first glance.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rules">Rules<a href="#rules" class="hash-link" aria-label="Direct link to Rules" title="Direct link to Rules">​</a></h2>
<p>Rule-based attacks are considered a programming language in the sense that they notify the cracking software of what to do once the software receives a string. hashcat&#x27;s Wiki has some great examples of this:</p>
<table><thead><tr><th width="156">Name</th><th width="97">Function</th><th>Description</th><th width="129">Example Rule</th><th width="124">Input Word</th><th>Output Word</th></tr></thead><tbody><tr><td>Nothing</td><td>:</td><td>Do nothing (pass-through)</td><td>:</td><td>p@ssW0rd</td><td>p@ssW0rd</td></tr><tr><td>Lowercase</td><td>l</td><td>Lowercase all letters</td><td>l</td><td>p@ssW0rd</td><td>p@ssw0rd</td></tr><tr><td>Uppercase</td><td>u</td><td>Uppercase all letters</td><td>u</td><td>p@ssW0rd</td><td>P@SSW0RD</td></tr><tr><td>Capitalize</td><td>c</td><td>Capitalize the first letter and lower the rest</td><td>c</td><td>p@ssW0rd</td><td>P@ssw0rd</td></tr></tbody></table>
<p>These are a couple of examples I had copied over from <a href="https://hashcat.net/wiki/doku.php?id=rule_based_attack" target="_blank" rel="noopener noreferrer">https://hashcat.net/wiki/doku.php?id=rule_based_attack</a>. Using the above rows as examples, we can create a file that has one rule for the lowercase letters:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Lowercase rule</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">l</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>That&#x27;s it. We have created one rule that will lowercase all of the strings we pass through to the cracking software. We can test it by creating a MD5 hash for the word &quot;testing123&quot;. We can then create a dictionary list with the following strings in it:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Hello</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">This</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Testing123</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Hashcat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Cracking</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If our rule works as it should, it will lowercase &quot;Testing123&quot; to &quot;testing123&quot;, and crack our hash for us. We can use hashcat with the following command to get this output: <code>hashcat -m 0 hash -r rule_created.rule hash.dict</code>.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image747-378ac071869208522f05d1389dc81204.png" width="381" height="63" class="img_ev3q"></p>
<p>We have now created one rule. Rule files usually have a rule on each line and can look like the following (excerpt taken from <a href="https://github.com/hashcat/hashcat/blob/master/rules/best66.rule" target="_blank" rel="noopener noreferrer">https://github.com/hashcat/hashcat/blob/master/rules/best66.rule</a>):</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">r</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$e</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">D2 D2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+5 ] } } } } &#x27;4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>I would encourage you to check out the <a href="https://hashcat.net/wiki/doku.php?id=rule_based_attack" target="_blank" rel="noopener noreferrer">aforementioned hashcat Wiki documentation</a>. They give a great breakdown of what each of the values mean. There are some rule files that are well known in the industry, such as: <a href="https://github.com/NotSoSecure/password_cracking_rules" target="_blank" rel="noopener noreferrer">OneRuleToRuleThemAll</a>, <a href="https://github.com/stealthsploit/OneRuleToRuleThemStill" target="_blank" rel="noopener noreferrer">OneRuleToRuleThemStill</a>, and <a href="https://github.com/praetorian-inc/Hob0Rules" target="_blank" rel="noopener noreferrer">Hob0Rules</a>. They are created based on statistics and industry standards for passwords. NotSoSecure has some great rule comparison charts on their website: <a href="https://notsosecure.com/one-rule-to-rule-them-all" target="_blank" rel="noopener noreferrer">https://notsosecure.com/one-rule-to-rule-them-all</a>. </p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mask">Mask<a href="#mask" class="hash-link" aria-label="Direct link to Mask" title="Direct link to Mask">​</a></h2>
<p>Mask attacks work by trying all combinations in a specified key-space. I do want to specify that mask attacks do use brute-force, but just in a more &quot;smarter&quot; manner. I&#x27;ll quote the example hashcat uses on their <a href="https://hashcat.net/wiki/doku.php?id=mask_attack" target="_blank" rel="noopener noreferrer">site</a> to describe this, as I believe it is pretty well written. I have modified the following to be more concise:</p>
<blockquote>
<p>Here is a single example. We want to crack the password: <em>Julia1984</em></p>
<p>In traditional Brute-Force attack we require a charset that contains all upper-case letters, all lower-case letters and all digits (aka “mixalpha-numeric”). The Password length is 9, so we have to iterate through 62^9 (13.537.086.546.263.552) combinations. Lets say we crack with a rate of 100M/s, this requires more than <strong>4 years</strong> to complete.</p>
<p>In Mask attack we know about humans and how they design passwords. The above password matches a simple but common pattern. A name and year appended to it. We can also configure the attack to try the upper-case letters only on the first position ... To make it short, with Mask attack we can reduce the keyspace to 52*26*26*26*26*10*10*10*10 (237.627.520.000) combinations. With the same cracking rate of 100M/s, this requires just <strong>40 minutes</strong> to complete.</p>
</blockquote>
<p>You can think of this as permutation with repetition as well. You have to get the order of each position correctly to crack the hash. However, since we know the types of values used (lowercase char, uppercase char, integer, special character, etc.), we can then reduce the amount of brute-forcing we will have to do. hashcat has a list of built-in charsets for mask attacks:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">?l = abcdefghijklmnopqrstuvwxyz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">?u = ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">?d = 0123456789</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">?h = 0123456789abcdef</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">?H = 0123456789ABCDEF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">?s = «space»!&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`{|}~</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">?a = ?l?u?d?s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">?b = 0x00 - 0xff</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If we know a password is 8 characters long, and we know the password is all lowercase alphabets, we can set a mask to account for that exactly that. Let use the password &quot;password&quot; as an example:</p>
<p><code>hashcat -m 0 -a 3 5f4dcc3b5aa765d61d8327deb882cf99 ?l?l?l?l?l?l?l?l</code></p>
<p>The <code>-m 0</code> means that we are cracking an MD5 hash. The <code>-a 3</code> means that we are using the brute-force attack. <code>5f4dcc3b5aa765d61d8327deb882cf99</code> is the MD5 hash for &quot;password&quot;.  <code>?l?l?l?l?l?l?l?l</code> is the mask.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image748-c206d1853bfdf3f0222b671dfd84f3e9.png" width="359" height="46" class="img_ev3q"></p>
<p>During my research, I did see a repository of masks that are claimed to be used in corporate environments: <a href="https://github.com/golem445/Corporate_Masks" target="_blank" rel="noopener noreferrer">https://github.com/golem445/Corporate_Masks</a>. I have not used it myself, but it does seem to be promising.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rule-vs-mask">Rule vs. Mask<a href="#rule-vs-mask" class="hash-link" aria-label="Direct link to Rule vs. Mask" title="Direct link to Rule vs. Mask">​</a></h2>
<p>While rules modify a complete string (by either appending to it or modifying it completely), a mask modifies each part of a string. In addition, a mask allows you to specify which types of values are at which location. There are times where a mask can be used to crack the same hash as a rule, but they each have different end goals. Based on my research, mask attacks do not use a wordlist, as the mask is the wordlist per-se. </p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hybrid">Hybrid<a href="#hybrid" class="hash-link" aria-label="Direct link to Hybrid" title="Direct link to Hybrid">​</a></h2>
<p>While doing research for this blog, I also discovered an attack that caught my attention. This is an attack that combines a dictionary on one side, and a brute-force value on the other. The brute-force can be done with masks or rules, according to the hashcat Wiki. This would be attack mode 6 or 7 (depending on position of wordlist and mask) from the hashcat arguments:</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image749-51be9cd91ec16e368c2ed3643583f52a.png" width="272" height="190" class="img_ev3q"></p>
<p>Lets go with the example of &quot;testing123&quot; again. For this we create a .dict file to specify that this will be our dictionary/wordlist to be used for this attack. I will add &quot;testing&quot; to this file. Since we know the password has three numbers at the end, we will use the mask of `?d?d?d`. The full command would be the following:<code>hashcat -a 6 -m 0 hash hash.dict ?d?d?d</code></p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="428" height="41" class="img_ev3q"></p>
<p>The perk of using the Hybrid mode for me is saving the time I would need to use cewl or crunch to generate multiple wordlists and then run each wordlist through hashcat.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="purple-rain-princeprocessor">Purple Rain (princeprocessor)<a href="#purple-rain-princeprocessor" class="hash-link" aria-label="Direct link to Purple Rain (princeprocessor)" title="Direct link to Purple Rain (princeprocessor)">​</a></h2>
<p>I had not heard about this attack until I saw it referenced on <a href="https://github.com/J3rryBl4nks/PasswordCrackingMethodology" target="_blank" rel="noopener noreferrer">J3rryBl4nks&#x27; PasswordCrackingMethodology repo</a>. This can be considered as an advanced Combinator attack. The description provided by <a href="https://www.netmux.com/blog/purple-rain-attack" target="_blank" rel="noopener noreferrer">netmux</a> explains it really well:</p>
<blockquote>
<p>It&#x27;s gonna give you password patterns and rule sets that you&#x27;d NEVER come up with on your own. It is very useful at chaining together usable patterns and passwords, and when left on it&#x27;s own, supplied with a simple dictionary, could easily crack 75% of the LinkedIn dataset in 24hrs. Are ALL the patterns and passwords going to be useful? No. Are you going to run this attack many times and NOT crack the critical hashes you need? Yes. BUT one day, at some point, this attack will run and these magical cracked hashes will start slowly trickling down from the password gods filling your terminal.</p>
</blockquote>
<p>If you want to read more about it, I would recommend checking out <a href="https://reusablesec.blogspot.com/2014/12/tool-deep-dive-prince.html" target="_blank" rel="noopener noreferrer">https://reusablesec.blogspot.com/2014/12/tool-deep-dive-prince.html</a> as well.</p>
<p>I liked the idea behind this attack because it does two things: assists with removing bias and &quot;randomizes&quot; the potential password generation. This definitely has the &quot;so crazy that it might just work&quot; feel to it. The following three items are needed for this attack:</p>
<ul>
<li>The hashcat binary</li>
<li><a href="https://github.com/hashcat/princeprocessor" target="_blank" rel="noopener noreferrer">princeprocessor Hashcat Utility</a> (does not seem to be default in Kali installs)</li>
<li>List of dictionaries<!-- -->
<ul>
<li>J3rryBl4nks mentions they use the hashkiller-dict.txt wordlist from <a href="https://hashkiller.io/download" target="_blank" rel="noopener noreferrer">https://hashkiller.io/download</a></li>
</ul>
</li>
</ul>
<p>We can then use the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">shuf</span><span class="token plain"> dict.txt </span><span class="token operator">|</span><span class="token plain"> pp64.bin --pw-min</span><span class="token operator">=</span><span class="token number">8</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> hashcat </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-a</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-m</span><span class="token plain"> MODE_HERE </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-w</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-O</span><span class="token plain"> hashes.txt </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-g</span><span class="token plain"> </span><span class="token number">300000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># shuf - shuffle our dictionary before piping into PRINCEprocessor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># dict.txt - Targeted or General Purpose dictionary of your choosing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># pp64.bin - PRINCEprocessor utility from Hashcat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># --pw-min=8 - tells PRINCE to generate minimum length of 8+ character passwords</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># hashcat -a 0 - starts Hashcat in Straight mode in order to take stdin input</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># -m MODE_HERE - specify hash mode number, for instance -m 1000 is NTLM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># -w 4 - tells Hashcat to use highest workload setting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># hashes.txt - your file containing hashes to crack</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># -g 300000 - tells Hashcat to generate 300,000 random rules</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Based on <a href="https://reusablesec.blogspot.com/2014/12/tool-deep-dive-prince.html" target="_blank" rel="noopener noreferrer">Matt Weir&#x27;s research</a>, it seems that dictionary attacks perform much better than the princeprocessor attack over their cracking sessions. However, since princeprocessor generates its rules automatically on the go, it keeps on running even after a rule set is completed. Based on my own research, this attack seems to be a last resort for cracking hashes, since you can run it and &quot;forget about it&quot;. As pen-tests have deadlines, I would recommend running this as soon as you can, while still running the standard dictionary attacks separately (if you have the bandwidth).</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="alternative-dictionaries">Alternative Dictionaries<a href="#alternative-dictionaries" class="hash-link" aria-label="Direct link to Alternative Dictionaries" title="Direct link to Alternative Dictionaries">​</a></h2>
<p>When it comes to password cracking wordlists, the defaults that people go to are rockyou.txt and any of the <a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords" target="_blank" rel="noopener noreferrer">SecLists</a> wordlists. There were times I had participated in Capture The Flag events where rockyou.txt or some of the SecLists wordlists did not crack the hash. This was without any rules or masks attached. For those instances, I relied on other dictionaries. I have listed a couple others below:</p>
<p><a href="https://weakpass.com/" target="_blank" rel="noopener noreferrer">Weakpass</a></p>
<p><a href="https://github.com/berzerk0/Probable-Wordlists/tree/master/Real-Passwords" target="_blank" rel="noopener noreferrer">berzerk0/Probable-Wordlists</a></p>
<p>There were also times where I had created my own dictionaries based on the scenario. For those, I ended up using <a href="https://www.kali.org/tools/crunch/" target="_blank" rel="noopener noreferrer">crunch</a>, <a href="https://github.com/sc0tfree/mentalist" target="_blank" rel="noopener noreferrer">Mentalist</a>, or <a href="https://www.harisqazi.com/scripts/wordlist-generator" target="_blank" rel="noopener noreferrer">my own wordlist generator</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="password-analysis">Password Analysis<a href="#password-analysis" class="hash-link" aria-label="Direct link to Password Analysis" title="Direct link to Password Analysis">​</a></h2>
<p>Password analysis can be used to create rules and masks that might be more specific to an organization or an individual. People are known to re-use passwords for multiple accounts, so analyzing that data can be a great source to work off of for us. Analysis can be done manually or automatically. I personally have done it manually by using other breaches a person has been in to assume what passwords they might use next. Using that assumption, you can create a possible password wordlist, and then add a rule or mask to that to crack the new hash(es). I have found some automated tools that might assist with password analysis as well:</p>
<p><a href="https://github.com/shmuelamar/cracken" target="_blank" rel="noopener noreferrer">shmuelamar/cracken</a></p>
<p><a href="https://github.com/digininja/pipal" target="_blank" rel="noopener noreferrer">digininja/pipal</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases">Use Cases<a href="#use-cases" class="hash-link" aria-label="Direct link to Use Cases" title="Direct link to Use Cases">​</a></h2>
<p>There are two main use cases that comes to mind when it comes to using advanced hash cracking strategies. From a pen-testing perspective, it gives you a way to break free from the dictionary itself and be able to manipulate it the way you want. Using masks, or even tools such as cewl and crunch, you can create your own wordlists and are able to do more. If we are given a corporate password policy, we can use that to remove all passwords from rockyou.txt that would not be possible with the policy (ex. passwords that are too short). Using something like the &quot;Purple Rain&quot; attack, we can then have an automated way of creating rules, thus giving us an opportunity to crack unique password formats.</p>
<p>From an OSINT perspective, you can use hashes cracked from other breaches to assume passwords for other platforms. If you are trying to crack a hash of a whale (high profile executive), you can use items related to them (kids, parents, pets, etc.) to create possible passwords. In addition to that, you can use platforms such as DeHashed and HaveIBeenPwned to see what breaches their personal email was part of. Then cracking those hashes we can assume what their password can be for this platform as well. There have been times where a password has told me more than I needed about a person. First, it told me if they might have other email accounts as well (since you can see other accounts in a breach with the same hash/password). It also told me keywords that might mean something to the user. Those keywords can be pivot points themselves or reemphasize other pivot points you had previously discovered. The goal is not to log into other platforms using a subject&#x27;s/target&#x27;s credentials, <strong>that is NOT OSINT and is illegal</strong>. Using the information in just the password to create pivot points is OSINT.</p>
<p>Are these use cases really niche. Yes, yes they are. They are also realistic and cases I have encountered myself or personally know others who have.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sources">Sources<a href="#sources" class="hash-link" aria-label="Direct link to Sources" title="Direct link to Sources">​</a></h2>
<ul>
<li><a href="https://hashcat.net/wiki/doku.php?id=rule_based_attack" target="_blank" rel="noopener noreferrer">https://hashcat.net/wiki/doku.php?id=rule_based_attack</a></li>
<li><a href="https://www.4armed.com/blog/hashcat-rule-based-attack/" target="_blank" rel="noopener noreferrer">https://www.4armed.com/blog/hashcat-rule-based-attack/</a></li>
<li><a href="https://www.kitploit.com/2022/08/awesome-password-cracking-curated-list.html" target="_blank" rel="noopener noreferrer">https://www.kitploit.com/2022/08/awesome-password-cracking-curated-list.html</a></li>
<li><a href="https://hashcat.net/wiki/doku.php?id=mask_attack" target="_blank" rel="noopener noreferrer">https://hashcat.net/wiki/doku.php?id=mask_attack</a></li>
<li><a href="https://hashcat.net/wiki/doku.php?id=hybrid_attack" target="_blank" rel="noopener noreferrer">https://hashcat.net/wiki/doku.php?id=hybrid_attack</a></li>
<li><a href="https://github.com/J3rryBl4nks/PasswordCrackingMethodology" target="_blank" rel="noopener noreferrer">https://github.com/J3rryBl4nks/PasswordCrackingMethodology</a></li>
<li><a href="https://www.netmux.com/blog/purple-rain-attack" target="_blank" rel="noopener noreferrer">https://www.netmux.com/blog/purple-rain-attack</a></li>
<li><a href="https://reusablesec.blogspot.com/2014/12/tool-deep-dive-prince.html" target="_blank" rel="noopener noreferrer">https://reusablesec.blogspot.com/2014/12/tool-deep-dive-prince.html</a></li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/category/network"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Network</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#rules" class="table-of-contents__link toc-highlight">Rules</a></li><li><a href="#mask" class="table-of-contents__link toc-highlight">Mask</a></li><li><a href="#rule-vs-mask" class="table-of-contents__link toc-highlight">Rule vs. Mask</a></li><li><a href="#hybrid" class="table-of-contents__link toc-highlight">Hybrid</a></li><li><a href="#purple-rain-princeprocessor" class="table-of-contents__link toc-highlight">Purple Rain (princeprocessor)</a></li><li><a href="#alternative-dictionaries" class="table-of-contents__link toc-highlight">Alternative Dictionaries</a></li><li><a href="#password-analysis" class="table-of-contents__link toc-highlight">Password Analysis</a></li><li><a href="#use-cases" class="table-of-contents__link toc-highlight">Use Cases</a></li><li><a href="#sources" class="table-of-contents__link toc-highlight">Sources</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright"> <p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="http://www.harisqazi.com">Portfolio</a> by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="http://www.harisqazi.com">Haris Qazi</a> is licensed under <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">Creative Commons Attribution 4.0 International<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg" alt=""></a></p> </div></div></div></footer></div>
</body>
</html>