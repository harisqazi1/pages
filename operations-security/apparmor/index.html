<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-operations-security/apparmor" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">AppArmor | Haris Qazi</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.harisqazi.com/img/blog_image.cleaned.jpeg"><meta data-rh="true" name="twitter:image" content="https://www.harisqazi.com/img/blog_image.cleaned.jpeg"><meta data-rh="true" property="og:url" content="https://www.harisqazi.com/operations-security/apparmor"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="AppArmor | Haris Qazi"><meta data-rh="true" name="description" content="Trying out the AppArmor Mandatory Access Control solution"><meta data-rh="true" property="og:description" content="Trying out the AppArmor Mandatory Access Control solution"><link data-rh="true" rel="icon" href="/img/HQ-Logo-Dark.png"><link data-rh="true" rel="canonical" href="https://www.harisqazi.com/operations-security/apparmor"><link data-rh="true" rel="alternate" href="https://www.harisqazi.com/operations-security/apparmor" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.harisqazi.com/operations-security/apparmor" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Haris&#39;s Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Haris&#39;s Blog Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Haris&#39;s Blog JSON Feed"><link rel="stylesheet" href="/assets/css/styles.5ac50148.css">
<script src="/assets/js/runtime~main.7cbbf780.js" defer="defer"></script>
<script src="/assets/js/main.ede0d9bd.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.harisqazi.com/" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/HQ-Logo-Light.png" alt="Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/HQ-Logo-Dark.png" alt="Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Haris Qazi</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Portfolio</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://codeberg.org/Harisfromcyber/pages" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Source Code<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite" aria-pressed="true"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/privacy">Privacy Policy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/resume">Resume</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/configurations">Configurations</a><button aria-label="Expand sidebar category &#x27;Configurations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/category/operations-security-opsec">Operations Security (OPSEC)</a><button aria-label="Collapse sidebar category &#x27;Operations Security (OPSEC)&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/operations-security/basic-software-investigation">Basic Software Investigation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/operations-security/application-sandboxing">Application Sandboxing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/operations-security/apparmor">AppArmor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/operations-security/personal-attack-surface-management">Personal Attack Surface Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/operations-security/cpu-backdoors">CPU Backdoors</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/open-source-intelligence-osint">Open-Source Intelligence (OSINT)</a><button aria-label="Expand sidebar category &#x27;Open-Source Intelligence (OSINT)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/red-team-operations">Red Team Operations</a><button aria-label="Expand sidebar category &#x27;Red Team Operations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/operations-security-opsec"><span itemprop="name">Operations Security (OPSEC)</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">AppArmor</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>AppArmor</h1></header>
<p>This blog is a continuation of me looking into solutions for managing application permissions, in this case with Mandatory Access Control.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="authors-note">Author&#x27;s Note<a href="#authors-note" class="hash-link" aria-label="Direct link to Author&#x27;s Note" title="Direct link to Author&#x27;s Note">​</a></h4>
<p>This blog was initially planned to include AppArmor <strong>and</strong> SELinux. After reading the beginning chapters of the SELinux System Administration, Third Edition and SELinux Cookbook from Sven Vermeulen, I realized that SELinux is not worth diving into for my uses. I honestly gave it the same shot that I give all other new technology I test out. For me, the learning curve is just too severe for this to be of use to me. The amount of granular configuration that SELinux provides is great - but it comes at the cost of usability. Also, I don&#x27;t want to accidentally lock myself out of my main machine due to me forgetting to run <code>restorecon</code> on a folder I modified or something along those lines. It is a great tool, just not for me at this time.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="testing-environment">Testing Environment<a href="#testing-environment" class="hash-link" aria-label="Direct link to Testing Environment" title="Direct link to Testing Environment">​</a></h2>
<p>I will be using a similar testing environment to my Application Sandboxing blog. I will be using Pop!_OS 22.04 on KVM/QEMU. The following command gets this up and running:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">virt-install --virt-type</span><span class="token operator">=</span><span class="token plain">kvm </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--name</span><span class="token plain"> PopOS </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--vcpus</span><span class="token operator">=</span><span class="token number">2</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--memory</span><span class="token operator">=</span><span class="token number">4096</span><span class="token plain"> --os-variant</span><span class="token operator">=</span><span class="token plain">popos20.04 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--cdrom</span><span class="token operator">=</span><span class="token plain">/var/lib/libvirt/images/pop-os_22.04_amd64_intel_43.iso  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--network</span><span class="token operator">=</span><span class="token plain">default </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--disk</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">size</span><span class="token operator">=</span><span class="token number">40</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Similar commands for VM management as previously mentioned as well:</p>
<ul>
<li>List all VMs: <code>virsh list --all</code></li>
<li>Start PopOS (or VM name): <code>virsh start PopOS</code></li>
<li>GUI view into a running VM: <code>virt-viewer --connect qemu:///system PopOS</code></li>
<li>Find IP Address of VM (for SSH): <code>virsh domifaddr --domain PopOS</code></li>
<li>To shutdown: <code>virsh destroy PopOS</code></li>
</ul>
<p>I did mess up my VM while working on the Application Hardening blog by trying to switch from X11 to Wayland. I edited some configuration files and that led to a constant issue with the display. It would have been nice to have a snapshot for that VM...which I did not have. For this blog, I am also including the command I am using for snapshots as well. Before the snapshot I did the following:</p>
<ul>
<li>modified the resolution to 1920x1080</li>
<li>Installed SSH <code>sudo apt install openssh*</code> - this automatically enables it as well (helpful to SSH into a VM without the GUI)</li>
<li>Updated and upgraded the system with <code>sudo apt update &amp;&amp; sudo apt upgrade -y</code></li>
<li>Modified the Power Saving Options: <code>Screen Blank: Never</code> and <code>Automatic Suspend: Off</code></li>
</ul>
<p>To snapshot the system, I ran <code>virsh snapshot-create-as --domain PopOS --name &quot;PopUpdate and Upgrade&quot;</code>. This took about 2 minutes to complete. You should be able to revert by running <code>virsh snapshot-revert --domain PopOS --snapshotname PopUpdate and Upgrade</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="background---types-of-access-controls">Background - Types of Access Controls<a href="#background---types-of-access-controls" class="hash-link" aria-label="Direct link to Background - Types of Access Controls" title="Direct link to Background - Types of Access Controls">​</a></h2>
<p>Access controls are &quot;a type of security measure that limits the visibility, access, and use of resources in a computing environment&quot; [3]. According to SentinelOne, there are currently 5 types of access controls [3]:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="discretionary-access-control-dac"><strong>Discretionary Access Control (DAC)</strong><a href="#discretionary-access-control-dac" class="hash-link" aria-label="Direct link to discretionary-access-control-dac" title="Direct link to discretionary-access-control-dac">​</a></h4>
<p>DAC is the easiest and most flexible type of access control model to work with. In DAC, the owner of the resource exercises his privilege to allow others access to his resources. But the spontaneity in granting this permission has flexibilities, and at the same time creates a security hazard if the permissions are handled injudiciously. DAC is prevalently found in environments where sharing of data is very much appreciated, but in very sensitive cases, it might not be appropriate.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mandatory-access-control-mac"><strong>Mandatory Access Control (MAC)</strong><a href="#mandatory-access-control-mac" class="hash-link" aria-label="Direct link to mandatory-access-control-mac" title="Direct link to mandatory-access-control-mac">​</a></h4>
<p>MAC is a stricter access control model in which access rights are controlled by a central authority – for example system administrator. Besides, users have no discretion as to permissions, and authoritative data that is usually denomination in access control is in security labels attached to both the user and the resource. It is implemented in government and military organizations due to enhanced security and performance.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="role-based-access-control-rbac"><strong>Role Based Access Control (RBAC)</strong><a href="#role-based-access-control-rbac" class="hash-link" aria-label="Direct link to role-based-access-control-rbac" title="Direct link to role-based-access-control-rbac">​</a></h4>
<p>RBAC is one of the prominent access control models that are in practice in various organizations. The access rights are granted according to the positions within this organization. For example, a manager may be allowed to view some documents that an ordinary worker does not have permission to open. RBAC makes management easier because permissions are related to roles and not users, thus making it easier to accommodate any number of users.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="abac-attribute-based-access-control"><strong>ABAC (Attribute-Based Access Control)</strong><a href="#abac-attribute-based-access-control" class="hash-link" aria-label="Direct link to abac-attribute-based-access-control" title="Direct link to abac-attribute-based-access-control">​</a></h4>
<p>Contrasted to RBAC, ABAC goes beyond roles and considers various other attributes of a user when determining the rights of access. Some of these can be the user’s role, the time of access, location, and so on. This model gives high granularity and flexibility; hence, an organization could implement complex access policy rules that will adapt to different scenarios.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="rule-based-access-control-rubac"><strong>Rule-Based Access Control (RuBAC)</strong><a href="#rule-based-access-control-rubac" class="hash-link" aria-label="Direct link to rule-based-access-control-rubac" title="Direct link to rule-based-access-control-rubac">​</a></h4>
<p>RuBAC is an extension of RBAC in which access is governed by a set of rules that the organization prescribes. These rules can thus factor in such things as the time of the day, the user’s IP address, or the type of device a user is using. RuBAC is especially suitable to be applied in conditions where access should be changed according to certain conditions within the environment.</p>
<p><strong>For this blog, we will only focus on Mandatory Access Control.</strong></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>There are 2 popular MACs when it comes to Linux: AppArmor and SELinux. AppArmor is default on distributions in the Ubuntu and SUSE derived systems, while SELinux is default in the RHEL (Red Hat Enterprise Linux) and Fedora derived systems. I will dive deep into AppArmor going forward, but I just wanted to hint at a theme going forward: AppArmor works on an application by application basis, while SELinux works on every user and file on system itself. This gives SELinux much more complexity and granularity than AppArmor.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="selinux-vs-apparmor">SELinux vs. AppArmor<a href="#selinux-vs-apparmor" class="hash-link" aria-label="Direct link to SELinux vs. AppArmor" title="Direct link to SELinux vs. AppArmor">​</a></h2>
<p>I read the following well written comparison between SELinux and AppArmor in the Mastering Linux Security and Hardening book (link #4) that I felt would work really well here:</p>
<ul>
<li>SELinux labels all system processes and all objects such as files, directories, or network ports. For files and directories, SELinux stores the labels in their respective inodes as extended attributes. (An inode is the basic filesystem component that contains all information about a file, except for the filename.)</li>
<li>AppArmor uses pathname enforcement, which means that you specify the path to the executable file that you want AppArmor to control. This way, here’s no need to insert labels into the extended attributes of files or directories.</li>
<li>With SELinux, you have system-wide protection out of the box.</li>
<li>With AppArmor, you have a profile for each individual application.</li>
<li>With either SELinux or AppArmor, you might occasionally find yourself having to create custom policy modules from scratch, especially if you’re dealing with either third-party applications or homegrown software. With AppArmor, this is easier, because the syntax for writing AppArmor profiles is much easier than the syntax for writing SELinux policies. And AppArmor comes with utilities that can help you automate the process.</li>
<li>Just as SELinux can, AppArmor can help prevent malicious actors from ruining your day and can help protect user data.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sandboxing-vs-mandatory-access-control">Sandboxing vs. Mandatory Access Control<a href="#sandboxing-vs-mandatory-access-control" class="hash-link" aria-label="Direct link to Sandboxing vs. Mandatory Access Control" title="Direct link to Sandboxing vs. Mandatory Access Control">​</a></h2>
<p>In the previous blog &quot;Application Sandboxing&quot;, I discussed sandboxing solutions such as Firejail and Bubblewrap. I wanted to have a small section describing the difference between what a sandbox provides and what a MAC (like AppArmor and SELinux) provide. First, both work on different levels on the operating system. Sandboxing works in user space (a.k.a userland) while MACs work in kernel space [5]. Red Hat does a good job at phrasing the difference [6]:</p>
<p>User space:</p>
<blockquote>
<p>User space refers to all of the code in an operating system that lives outside of the kernel. Most Unix-like operating systems (including Linux) come pre-packaged with all kinds of utilities, programming languages, and graphical tools - these are user space applications. We often refer to this as “userland.”</p>
<p>Userland applications can include programs that are written in C, Java, Python, Ruby, and other languages. In a containerized world, these programs are typically delivered in a container image format such as Docker. When you pull down and run a Red Hat Enterprise Linux 7 container image from the Red Hat Registry, you are utilizing a pre-packaged, minimal Red Hat Enterprise Linux 7 user space which contains utilities such as bash, awk, grep, and yum (so that you can install other software).</p>
<p>All user programs (containerized or not) function by manipulating data, but where does this data live? This data can come from registers in the CPU and external devices, but most commonly it is stored in memory and on disk. User programs get access to data by making special requests to the kernel called system calls. Examples include allocating memory (variables) or opening a file. Memory and files often store sensitive information owned by different users, so access must be requested from the kernel through system calls.</p>
</blockquote>
<p>Kernel space:</p>
<blockquote>
<p>The kernel provides abstraction for security, hardware, and internal data structures. The open() system call is commonly used to get a file handle in Python, C, Ruby and other languages. You wouldn’t want your program to be able to make bit level changes to an XFS file system, so the kernel provides a system call and handles the drivers. In fact, this system call is so common that is part of the POSIX library.</p>
<p>Notice in the following drawing that bash makes a getpid() call which requests its own process identity. Also, notice that the cat command requests access to /etc/hosts with a file open() call. In the next article, we will dig into how this works in a containerized world, but notice that some code lives in user space, and some lives in the kernel.</p>
</blockquote>
<p>I saw an image on the Red Hat site that explains this well:</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="760" height="300" class="img_ev3q"></p>
<p>Programs like Firejail and Bubblewrap try to isolate programs/binaries at the user space level by using Linux features such as user namespaces (feature that Linux kernel provides to allow us to isolate resources for a set of processes) and seccomp (allows for filtering the syscalls invoked by a process and can thereby be used to restrict which syscalls a given process is allowed to execute) [7,9,10]. This gives them limited control when compared to MACs, which work at the kernel space level. MACs actually leverage the Linux Security Modules, which are frameworks that allow the Linux kernel to work with security models. &quot;LSM was designed in order to answer all the requirements for successfully implementing a mandatory access control module, while imposing the fewest possible changes to the Linux kernel&quot; [8]. This allows the MACs to deny access to kernel objects like files, inodes, credentials, and inter-process communication objects [11]. All this boils down to one statement: MACs are much more powerful tool as it&#x27;s control goes beyond the user space.</p>
<p>Now that the technical background is covered, let&#x27;s jump into working with AppArmor.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="apparmor-1">AppArmor<a href="#apparmor-1" class="hash-link" aria-label="Direct link to AppArmor" title="Direct link to AppArmor">​</a></h2>
<p>&quot;AppArmor is Mandatory Access Control (MAC) like security system for Linux. AppArmor confines individual programs to a set of files, capabilities, network access and rlimits, collectively known as the AppArmor policy for the program, or simply as a profile. New or modified policy can be applied to the running system without a reboot. AppArmor aims to be easy to understand and use for most common requirements by presenting its profiles in an administrator friendly language&quot; [12]. AppArmor works by leveraging executable path&#x27;s instead of the system-wide approach that SELinux. This means that if an application moves from <code>/usr/bin/application_name</code> to <code>/home/user/Documents/application_name</code>, the AppArmor profile will need to be updated to reflect this, otherwise AppArmor will <strong>not work</strong>.</p>
<p>On Debian-based distributions, AppArmor is enabled by default. This can be verified by running <code>systemctl status apparmor.service</code> and <code>aa-status</code>. If you want to see the pre-made profiles on your system, you can run <code>ls /etc/apparmor.d</code>. If those are not installed for any reason, that can be done by running <code>sudo apt install apparmor-easyprof apparmor-notify apparmor-utils apparmor-profiles apparmor-profiles-extra</code> [4,15].</p>
<p>Now let&#x27;s jump into making a custom AppArmor profile for Firefox. Here are the requirements I have for Firefox:</p>
<ul>
<li>No access to cameras</li>
<li>No root access</li>
<li>No access to any connected USB devices, other than keyboard</li>
<li>No access to most folders, other than what Firefox itself needs to run and maybe just <code>~/Downloads</code></li>
</ul>
<p>You can download command-line tools to assist with creating profiles from the command-line with <code>sudo apt install apparmor-utils</code> [4]. Instead of writing everything formally, I&#x27;ll just write notes that helped me to understand AppArmor [15]:</p>
<ul>
<li>Absolute paths (<code>/usr/bin/firefox</code>) and file globs (<code>/usr/*/firefox</code>) can be used for file access</li>
<li>File access rules include the following:<!-- -->
<ul>
<li>read (<code>r</code>)</li>
<li>write (<code>w</code>)</li>
<li>memory map as executable (<code>m</code>)</li>
<li>file locking (<code>k</code>)</li>
<li>creation of hard links (<code>l</code>)</li>
<li>executing another program with another program inheriting the policy (<code>ix</code>)</li>
<li>executable under another profile, after cleaning the environment (<code>Px</code>)</li>
<li>execute under a child profile, after cleaning the environment (<code>Cx</code>)</li>
<li>execute unconfined, after cleaning the environment (<code>Ux</code>)</li>
<li>etc.</li>
</ul>
</li>
<li>variables (ex. <code>@{HOME}</code> can be defined and manipulated outside the profile (<code>#include &lt;tunables/global&gt;</code> for <code>@{PROC}</code> and <code>@{HOME}</code>)</li>
<li>explicit deny rules are supported to override allow rules (ex access to <code>@{HOME}/bin/bad.sh</code> is denied with auditing due to <code>audit deny @{HOME}/bin/** mrwkl,</code> even though general access to <code>@{HOME}</code> is permitted with <code>@{HOME}/** rw,</code>)</li>
<li>You can inherit allow/deny capabilities by importing other files into your profile, such as <code>#include &lt;abstractions/audio&gt;</code>. This will import the &quot;rules&quot; from the audio file in the abstractions directory. This prevents rules from being typed out multiple times</li>
<li>It seems that <code>aa-easyprof</code> is superseded by <code>sudo aa-genprof</code> so the command to make a skeleton for your application would be <code>sudo aa-genprof /usr/bin/firefox</code>
<ul>
<li>After choosing from <code>(A)llow / [(D)eny] / (I)gnore / (G)lob / Glob with (E)xtension / (N)ew / Audi(t) / (O)wner permissions off / Abo(r)t / (F)inish</code>, I had a profile created. I did choose <code>(G)lob</code> when I felt the permission was too specific (for example, a specific Firefox profile directory - these change per install)</li>
</ul>
</li>
<li>To edit a profile, you run <code>sudo aa-complain /usr/bin/firefox</code>, then <code>sudo aa-logprof</code>. This will allow you to catch the &quot;complaints&quot; and then resolve them to update the profile</li>
<li>To finalize the profile, you will have to bounce back between running the application, <code>sudo aa-logprof</code>, and then back to the application. For Firefox, different files were being accessed over multiple sessions, so I had to account for those as well</li>
<li>After you are done with the changes, you just run <code>sudo aa-enforce application</code> to begin enforcing the policy</li>
<li><code>/usr/bin/aa-notify</code> will allow you to see AppArmor denials, which you can use to fine tune your profile as well</li>
<li>You can find more about profile languages here: <a href="https://gitlab.com/apparmor/apparmor/-/wikis/QuickProfileLanguage" target="_blank" rel="noopener noreferrer">QuickProfileLanguage · Wiki · AppArmor / apparmor · GitLab</a></li>
</ul>
<p>For Firefox, I ended up with the following (after tweaking settings for about a week):</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Last Modified: Mon Sep 23 17:41:43 2024</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">abi &lt;abi/3.0&gt;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">include &lt;tunables/global&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/lib/firefox/firefox flags=(complain) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  network inet dgram,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  network inet stream,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  network inet6 dgram,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  network inet6 stream,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  network netlink raw,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  network unix dgram,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  network unix seqpacket,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  network unix stream,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  signal (receive send) set=exists peer=/usr/lib/firefox/firefox,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  signal receive set=term peer=/usr/lib/firefox/firefox,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  signal send set=(kill term) peer=/usr/lib/firefox/firefox,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ptrace (read readby) peer=/usr/lib/firefox/firefox,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny / r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /boot/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /dev/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /etc/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /etc/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /home/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /media/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /mnt/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /opt/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /proc/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /root/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /srv/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /sys/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /usr/bin/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /usr/bin/apt-cache x,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /usr/lib/firefox/pingsender x,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /usr/share/applications/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /var/lib/flatpak/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny /var/lib/flatpak/app/io.gitlab.librewolf-community/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny owner /home/*/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny owner /home/*/.* r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny owner /home/user/.bash_logout r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny owner @{XDG_DESKTOP_DIR} r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny owner @{XDG_DOCUMENTS_DIR} r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny owner @{XDG_MUSIC_DIR} r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny owner @{XDG_PICTURES_DIR} r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny owner @{XDG_PUBLICSHARE_DIR} r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny owner @{XDG_TEMPLATES_DIR} r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  deny owner @{XDG_VIDEOS_DIR} r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /dev/** rw,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/fonts/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/gai.conf r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/glvnd/egl_vendor.d/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/gnome/defaults.list r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/gtk-3.0/settings.ini r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/host.conf r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/hosts r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/ld.so.cache r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/ld.so.conf r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/ld.so.conf.d/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/ld.so.conf.d/* r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/locale.alias r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/machine-id r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/mime.types r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/nsswitch.conf r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/pop-os/os-release r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/pulse/* r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/ssl/* r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /etc/vulkan/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /proc/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /run/systemd/resolve/stub-resolv.conf r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /run/user/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /sys/bus/pci/devices/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /sys/dev/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /sys/dev/char/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /sys/dev/char/* r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /sys/devices/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /sys/devices/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /sys/devices/pci0000:00/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /sys/devices/pci0000:00/**/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /sys/devices/system/cpu/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/bin/evince r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/bin/lsb_release mrix,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/bin/python3.10 ix,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/bin/python3.10 r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/lib/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/lib/firefox/* mr,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/lib/firefox/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/lib/firefox/firefox-bin mrix,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/lib/firefox/glxtest mrix,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/lib/locale/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/lib/python3.10/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/lib/python3.10/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/lib/python3/** mr,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/lib/x86_64-linux-gnu/* mr,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/lib/x86_64-linux-gnu/** mr,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/lib32/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/lib64/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/libx32/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/local/lib/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/local/lib/python3.10/dist-packages/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/local/share/fonts/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/local/share/fonts/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/sbin/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /usr/share/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /var/cache/fontconfig/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /var/lib/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /var/lib/flatpak/exports/share/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /var/lib/snapd/desktop/*/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /var/lib/snapd/desktop/applications/* r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/*/.bash_history r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/*/.cache/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/*/.cache/* rwk,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/*/.cache/** k,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/*/.cache/** rw,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/*/.config/** k,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/*/.config/** rw,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/*/.icons/ r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/*/.icons/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/*/.local/ rw,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/*/.mozilla/** m,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/*/.mozilla/** rwk,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/*/.mozilla/firefox/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/*/.themes/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/haris/.local/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /home/user/.local/share/* w,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /proc/** rw,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /run/user/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /run/user/** w,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /sys/fs/cgroup/** r,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /tmp/** rwk,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner /usr/lib/firefox/** rw,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  owner @{XDG_DOWNLOAD_DIR}/** rw,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This is about 141 lines. This took me 10-15 minutes to make, and then another 20 to test and finalize. One thing to note is that, this will <strong>not</strong> work for your machine, unless you are using Pop!_OS as well. If you want to use it feel free, and then run <code>aa-complain</code> and <code>aa-logprof</code> to tweak changes until it works for you. It was my first time making a profile, but I could go back and start cleaning and combing some rules as well, to make the profile much more user friendly. I did try using inheritance for this (&quot;include xyz&quot;), but that ended up having two rules go against each other and the profile did not end up working. However, it is <strong>highly</strong> recommended to use inheritance to prevent &quot;recreating the wheel&quot; for the rules. I have worked on some AppArmor profiles (one so far). If you wanted to check it out, the link to that is: <a href="https://github.com/harisqazi1/AppArmor-Profiles" target="_blank" rel="noopener noreferrer">GitHub - harisqazi1/AppArmor-Profiles</a>. That&#x27;s pretty much it. If you wanted some out-of-the-box profiles, check out <a href="https://github.com/roddhjav/apparmor.d" target="_blank" rel="noopener noreferrer">GitHub - roddhjav/apparmor.d: Full set of AppArmor profiles (~ 1500 profiles)</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="workflow">Workflow<a href="#workflow" class="hash-link" aria-label="Direct link to Workflow" title="Direct link to Workflow">​</a></h2>
<p>The typical workflow ends up being the following for AppArmor profiles:</p>
<p><img decoding="async" loading="lazy" src="/assets/images/Screenshot_2024-09-30_16-19-ae2c30421d18f5d17d721ef9791e1bc9.png" width="2377" height="833" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>After reading about both AppArmor and SELinux, I have a different respect for how easy AppArmor makes working with MACs. After this blog is over, I plan to make more profiles as I go. I want to get to a caliber where I can contribute to <a href="https://github.com/roddhjav/apparmor.d" target="_blank" rel="noopener noreferrer">GitHub - roddhjav/apparmor.d: Full set of AppArmor profiles (~ 1500 profiles)</a>, but that will be some time for now.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sources">Sources<a href="#sources" class="hash-link" aria-label="Direct link to Sources" title="Direct link to Sources">​</a></h2>
<ol>
<li><a href="https://www.cyberciti.biz/faq/how-to-create-create-snapshot-in-linux-kvm-vmdomain/" target="_blank" rel="noopener noreferrer">https://www.cyberciti.biz/faq/how-to-create-create-snapshot-in-linux-kvm-vmdomain/</a></li>
<li><a href="https://www.linuxtechi.com/create-revert-delete-kvm-virtual-machine-snapshot-virsh-command/" target="_blank" rel="noopener noreferrer">Create KVM Virtual Machine Snapshot with Virsh Command</a></li>
<li><a href="https://www.sentinelone.com/cybersecurity-101/cybersecurity/what-is-access-control/" target="_blank" rel="noopener noreferrer">What is Access Control? Types, Importance &amp; Best Practices</a></li>
<li><a href="https://www.packtpub.com/en-us/product/mastering-linux-security-and-hardening-9781837630516" target="_blank" rel="noopener noreferrer">Mastering Linux Security and Hardening - Third Edition | Security | eBook</a></li>
<li><a href="https://en.wikipedia.org/wiki/User_space_and_kernel_space" target="_blank" rel="noopener noreferrer">User space and kernel space - Wikipedia</a></li>
<li><a href="https://www.redhat.com/en/blog/architecting-containers-part-1-why-understanding-user-space-vs-kernel-space-matters" target="_blank" rel="noopener noreferrer">Architecting Containers Part 1: Why Understanding User Space vs. Kernel Space Matters</a></li>
<li><a href="https://github.com/netblue30/firejail" target="_blank" rel="noopener noreferrer">GitHub - netblue30/firejail: Linux namespaces and seccomp-bpf sandbox</a></li>
<li><a href="https://en.wikipedia.org/wiki/Linux%5C_Security%5C_Modules" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Linux\_Security\_Modules</a></li>
<li><a href="https://theboreddev.com/understanding-linux-namespaces/" target="_blank" rel="noopener noreferrer">Understanding Linux Namespaces » The Bored Dev</a></li>
<li><a href="https://www.redhat.com/sysadmin/container-security-seccomp" target="_blank" rel="noopener noreferrer">Improving Linux container security with seccomp | Enable Sysadmin</a></li>
<li><a href="https://www.starlab.io/blog/a-brief-tour-of-linux-security-modules/" target="_blank" rel="noopener noreferrer">A Brief Tour of Linux Security Modules — Star Lab Software</a></li>
<li><a href="https://gitlab.com/apparmor/apparmor/-/wikis/GettingStarted" target="_blank" rel="noopener noreferrer">GettingStarted · Wiki · AppArmor / apparmor · GitLab</a></li>
<li><a href="https://gitlab.com/apparmor/apparmor/-/wikis/About" target="_blank" rel="noopener noreferrer">About · Wiki · AppArmor / apparmor · GitLab</a></li>
<li><a href="https://ubuntu.com/server/docs/apparmor" target="_blank" rel="noopener noreferrer">https://ubuntu.com/server/docs/apparmor</a></li>
<li><a href="https://ubuntu.com/tutorials/beginning-apparmor-profile-development#1-overview" target="_blank" rel="noopener noreferrer">https://ubuntu.com/tutorials/beginning-apparmor-profile-development#1-overview</a></li>
<li><a href="https://www.packtpub.com/en-us/product/selinux-system-administration-third-edition-9781800201477" target="_blank" rel="noopener noreferrer">SELinux System Administration, Third Edition - Third Edition | Cloud &amp; Networking | eBook</a></li>
<li><a href="https://www.packtpub.com/en-us/product/selinux-cookbook-9781783989669" target="_blank" rel="noopener noreferrer">SELinux Cookbook | Cloud &amp; Networking | eBook</a></li>
<li><a href="https://opensource.com/sites/default/files/gated-content/cheat%5C_sheet%5C_selinux%5C_v2.pdf" target="_blank" rel="noopener noreferrer">https://opensource.com/sites/default/files/gated-content/cheat\_sheet\_selinux\_v2.pdf</a></li>
</ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/operations-security/application-sandboxing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Application Sandboxing</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/operations-security/personal-attack-surface-management"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Personal Attack Surface Management</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#testing-environment" class="table-of-contents__link toc-highlight">Testing Environment</a></li><li><a href="#background---types-of-access-controls" class="table-of-contents__link toc-highlight">Background - Types of Access Controls</a></li><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#selinux-vs-apparmor" class="table-of-contents__link toc-highlight">SELinux vs. AppArmor</a></li><li><a href="#sandboxing-vs-mandatory-access-control" class="table-of-contents__link toc-highlight">Sandboxing vs. Mandatory Access Control</a></li><li><a href="#apparmor-1" class="table-of-contents__link toc-highlight">AppArmor</a></li><li><a href="#workflow" class="table-of-contents__link toc-highlight">Workflow</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li><li><a href="#sources" class="table-of-contents__link toc-highlight">Sources</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright"> <p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="http://www.harisqazi.com">Portfolio</a> by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="http://www.harisqazi.com">Haris Qazi</a> is licensed under <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">Creative Commons Attribution 4.0 International<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg" alt=""></a></p> </div></div></div></footer></div>
</body>
</html>