<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-operations-security/basic-software-investigation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Basic Software Investigation | Haris Qazi</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.harisqazi.com/img/blog_image.cleaned.jpeg"><meta data-rh="true" name="twitter:image" content="https://www.harisqazi.com/img/blog_image.cleaned.jpeg"><meta data-rh="true" property="og:url" content="https://www.harisqazi.com/operations-security/basic-software-investigation"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Basic Software Investigation | Haris Qazi"><meta data-rh="true" name="description" content="Dynamic and Static Application Analysis"><meta data-rh="true" property="og:description" content="Dynamic and Static Application Analysis"><link data-rh="true" rel="icon" href="/img/HQ-Logo-Dark.png"><link data-rh="true" rel="canonical" href="https://www.harisqazi.com/operations-security/basic-software-investigation"><link data-rh="true" rel="alternate" href="https://www.harisqazi.com/operations-security/basic-software-investigation" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.harisqazi.com/operations-security/basic-software-investigation" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Haris&#39;s Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Haris&#39;s Blog Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Haris&#39;s Blog JSON Feed"><link rel="stylesheet" href="/assets/css/styles.03fad3ea.css">
<script src="/assets/js/runtime~main.5ff03685.js" defer="defer"></script>
<script src="/assets/js/main.e75deffc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.harisqazi.com/" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/HQ-Logo-Light.png" alt="Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/HQ-Logo-Dark.png" alt="Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Haris Qazi</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Portfolio</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/harisqazi1/portfolio" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite" aria-pressed="true"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/privacy">Privacy Policy</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/configurations">Configurations</a><button aria-label="Expand sidebar category &#x27;Configurations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/category/operations-security-opsec">Operations Security (OPSEC)</a><button aria-label="Collapse sidebar category &#x27;Operations Security (OPSEC)&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/operations-security/basic-software-investigation">Basic Software Investigation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/operations-security/application-sandboxing">Application Sandboxing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/operations-security/apparmor">AppArmor</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/open-source-intelligence-osint">Open-Source Intelligence (OSINT)</a><button aria-label="Expand sidebar category &#x27;Open-Source Intelligence (OSINT)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/red-team-operations">Red Team Operations</a><button aria-label="Expand sidebar category &#x27;Red Team Operations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/operations-security-opsec"><span itemprop="name">Operations Security (OPSEC)</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Basic Software Investigation</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Basic Software Investigation</h1></header>
<p>There are a lot of software out there that claim to be &quot;private&quot;. A lot of people, including myself, use these software without fully investigating them. A great example can be seen here: <a href="https://keyfindings.blog/2020/03/23/be-careful-what-you-osint-with/" target="_blank" rel="noopener noreferrer">https://keyfindings.blog/2020/03/23/be-careful-what-you-osint-with/</a>. This blog is my way of trying out various ways to capture and observe the connections and executions going out from apps, as a way to show how to monitor these. This is meant to be a tutorial and blog wrapped in one, for users to understand how to test closed-source applications (partially). <strong>This blog will focus primarily on Linux (the man-in-the-middle portion focuses on Windows), but the mentality is the same for Windows and macOS as well. Compatibility layers such as <code>wine</code> and <code>proton</code> allow for running Windows applications on Linux distributions, which means you can test the same Windows applications on Linux as well.</strong></p>
<p>The ideology behind this blog is as follows: Malware analysis is meant to analyze malicious software. As individuals who value privacy, we should be treating all software as malicious, until it is validated. Thus, the same tools that would be used for Malware Analysis can be used for us to validate and investigate the software we use on a daily basis.</p>
<p><em>Also, yes I see the irony in me using third-party tools to validate other third-party tools.</em></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tools">Tools<a href="#tools" class="hash-link" aria-label="Direct link to Tools" title="Direct link to Tools">​</a></h3>
<p>When it comes to malware analysis, there seem to be two main distributions that are used for this: <a href="https://docs.remnux.org/" target="_blank" rel="noopener noreferrer">REMnux</a> (Linux) and <a href="https://github.com/mandiant/flare-vm" target="_blank" rel="noopener noreferrer">FLARE-VM</a> (Windows). I will be using REMnux in this blog.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="behavioral-analysis">Behavioral Analysis<a href="#behavioral-analysis" class="hash-link" aria-label="Direct link to Behavioral Analysis" title="Direct link to Behavioral Analysis">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-connections-via-an-isolated-network-namespace">Network Connections via an Isolated Network Namespace<a href="#network-connections-via-an-isolated-network-namespace" class="hash-link" aria-label="Direct link to Network Connections via an Isolated Network Namespace" title="Direct link to Network Connections via an Isolated Network Namespace">​</a></h3>
<p>By default, a Linux distribution shares <strong>one</strong> set of network interfaces and routing table entries [2]. Network namespaces allow you to have &quot;separate instances of network interfaces and routing tables that operate independent of each other&quot; [2]. The following code leverages these namespaces allowing us to have a segmented networking area where only the software we are running will have outgoing network connections, allowing us to observe the traffic. The reason I used a namespace is to prevent regular network processes from interfering with the network processes coming out from an application we are looking into. [1] (cited below) uses commands split by text. I will combine that into a single script that can be run. <strong>Please review the <code>network_interface</code> and <code>IP_address</code> variables to make sure they are correct for your system before running.</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">#/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#I assume the first interface is local (lo) and the second is your primary interface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">network_interface</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">ip</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">link</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> show </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">grep</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;2:&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">grep</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-P</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">&#x27;(?&lt;=\:\s).*(?=\:\s\&lt;)&#x27;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#grabbing IP from hostname</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">IP_address</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">hostname</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-I</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#create a test network namespace</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> netns </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#create a pair of virtual network interfaces (veth-a and veth-b)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">link</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> veth-a </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">type</span><span class="token plain"> veth peer name veth-b</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#change the active namespace of the veth-a interface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">link</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> veth-a netns </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#configure the IP addresses of the virtual interfaces</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> netns </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">exec</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">test</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ifconfig</span><span class="token plain"> veth-a up </span><span class="token number">192.168</span><span class="token plain">.163.1 netmask </span><span class="token number">255.255</span><span class="token plain">.255.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ifconfig</span><span class="token plain"> veth-b up </span><span class="token number">192.168</span><span class="token plain">.163.254 netmask </span><span class="token number">255.255</span><span class="token plain">.255.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#configure the routing in the test namespace</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> netns </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">exec</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">test</span><span class="token plain"> route </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> default gw </span><span class="token number">192.168</span><span class="token plain">.163.254 dev veth-a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#activate ip_forward and establish a NAT rule to forward the traffic coming in from the namespace you created (you have to adjust the network interface and SNAT ip address)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> /proc/sys/net/ipv4/ip_forward</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">iptables </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-t</span><span class="token plain"> nat </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-A</span><span class="token plain"> POSTROUTING </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-s</span><span class="token plain"> </span><span class="token number">192.168</span><span class="token plain">.163.0/24 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$network_interface</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-j</span><span class="token plain"> SNAT --to-source </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$IP_address</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This script should be run as root (REMnux requires root for working with the ip commands we use): <code>sudo bash script.sh</code>. All apps that would need to be run in the namespace would be run with the following format (sudo is required): <code>sudo ip netns exec test your_program_here</code>. I will test the note-taking tool &quot;Obsidian&quot; in this blog.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="obsidian"><strong>Obsidian</strong><a href="#obsidian" class="hash-link" aria-label="Direct link to obsidian" title="Direct link to obsidian">​</a></h4>
<p>I downloaded the AppImage file from <a href="https://obsidian.md/" target="_blank" rel="noopener noreferrer">https://obsidian.md/</a> to get started. From there, I ran <code>chmod +x Obsidian-1.5.8.AppImage</code> to make the AppImage executable. I use <a href="https://gnome-terminator.org/" target="_blank" rel="noopener noreferrer">Terminator</a> to create two side-by-side windows to make it easy to keep track of the apps I am running. I run Wireshark (<code>ip netns exec test wireshark</code>) on the first terminal, choose the <code>veth-a</code> interface, then run Obsidian (<code>sudo ip netns exec test ./Obsidian-1.5.8.AppImage --no-sandbox</code>) on the next:</p>
<p><img decoding="async" loading="lazy" alt="Obsidian Screenshot" src="/assets/images/Screenshot_2024-03-09_12-19.cleaned-78a8bbd219ee2ca22d9e7971f6f00175.png" width="2079" height="1270" class="img_ev3q"></p>
<p>We start to see DNS and ARP requests start piling up into Wireshark. One thing to note here, is that this setup does <strong>not</strong> allow the program to connect to the internet. As such, we can only see outgoing connections and not back and forth communications between the application and its server. As for Obsidian, we get the following logs excerpt (removed duplicates to save space on the blog; I have also removed some information about my own system from this):</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">0.000000000 [IPv6 Address] → ff02::2      ICMPv6 70 Router Solicitation from [MAC Address]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">290.050304897 192.168.163.1 → 127.0.0.53   DNS 79 Standard query 0x65f5 A redirector.gvt1.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">290.050354057 192.168.163.1 → 127.0.0.53   DNS 79 Standard query 0x79e6 HTTPS redirector.gvt1.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">290.052591970 192.168.163.1 → 127.0.0.53   DNS 80 Standard query 0x8aef A releases.obsidian.md</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">290.052613015 192.168.163.1 → 127.0.0.53   DNS 80 Standard query 0x87b5 HTTPS releases.obsidian.md</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">460.328057970 192.168.163.1 → 127.0.0.53   DNS 75 Standard query 0xb73d A api.obsidian.md</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">460.328106250 192.168.163.1 → 127.0.0.53   DNS 75 Standard query 0xfb6a HTTPS api.obsidian.md</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>I didn&#x27;t see any connections that I don&#x27;t expect, so I am satisfied with this at the moment. When I tried to login, that is when it began to query the <code>api</code> subdomain, which I am assuming is where the credentials are verified.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="system-interactions-via-isolated-network-namespace">System Interactions via Isolated Network Namespace<a href="#system-interactions-via-isolated-network-namespace" class="hash-link" aria-label="Direct link to System Interactions via Isolated Network Namespace" title="Direct link to System Interactions via Isolated Network Namespace">​</a></h3>
<p>I don&#x27;t think that an isolated network namespace is <em>specifically</em> required for this, however, as this allows more segmentation at the network layer, I was comfortable with this setup. The tool I use here is <a href="https://github.com/draios/sysdig" target="_blank" rel="noopener noreferrer">sysdig</a>. In a similar manner to the previous section, executing commands will be a bit similar, but modified: <code>sudo ip netns exec test sysdig &gt; sysdig_obsidian.log</code> for syslog and <code>sudo ip netns exec test ./Obsidian-1.5.8.AppImage --no-sandbox</code> for Obsidian. Let&#x27;s break down the sysdig command a bit:</p>
<blockquote>
<p>sudo ip netns exec test sysdig &gt; sysdig_obsidian.log</p>
<p>sysdig - the executable to run</p>
<p>sysdig_obsidian.log - output or write this to sysdig_obsidian.log</p>
</blockquote>
<p>There is an option to output the file in .scap format, which can be read by running <code>sysdig -r obsidian_output_sysdig.scap</code>, however, the plain text version works for me. You could, of course, output to the scap, then read it to stream with sysdig, then output that to a text file.</p>
<p>In order to find the process name, I ran <code>sudo ip netns exec test sysdig -p&quot;%proc.name %fd.name&quot;</code> to see all running processes and file descriptors to see what was running. I then ran Obsidian on the other terminal to see what the output in sysdig would look like, leading me to find two process names for it being &quot;obsidian&quot; and &quot;Obsidian-1.5.8.&quot;. If there is only one process name, then <code>sudo ip netns exec test sysdig proc.name=obsidian &gt; sysdig_obsidian.log</code> will work.</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="242" height="125" class="img_ev3q"></p>
<blockquote>
<p>NOTE: If you wanted, you can run three windows: one for wireshark (mentioned in the previous section), one for sysdig, and the final for the application you want to inspect. This will allow for one run letting you see potentially all interactions at once.</p>
</blockquote>
<p>After outputting the file, I used <code>glogg</code> to read the contents of the file:</p>
<p><img decoding="async" loading="lazy" src="/assets/images/glogg.cleaned-1769b9346a2a0640fa9e1c9aff6522d2.png" width="2282" height="1107" class="img_ev3q"></p>
<p>While browsing the logs, nothing seemed out of place to me there either.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="man-in-the-middle">Man-in-the-middle<a href="#man-in-the-middle" class="hash-link" aria-label="Direct link to Man-in-the-middle" title="Direct link to Man-in-the-middle">​</a></h3>
<p>While looking for MITM solutions for Linux, I learned of two: PolarProxy and mitmproxy. They both work similarly by decrypting TLS traffic by becoming the middle-man (hence, man-in-the-middle).  mitmproxy currently has local redirect modes for <a href="https://mitmproxy.org/posts/local-redirect/windows/" target="_blank" rel="noopener noreferrer">Windows</a> and <a href="https://mitmproxy.org/posts/local-redirect/macos/" target="_blank" rel="noopener noreferrer">macOS</a>, but nothing for Linux yet. As such, here is the short list of steps I conducted to get this to work for Windows:</p>
<ol>
<li>Downloaded Windows 10 Enterprise LTSC 64-bit ISO file (regular Windows 10/11 Home should work as well)</li>
<li>In VirtualBox, I uploaded this ISO and gave it 3 CPU and 50 GB of space</li>
<li>After setup, in the VM, I downloaded the mitmproxy Installer from <a href="https://mitmproxy.org/" target="_blank" rel="noopener noreferrer">https://mitmproxy.org/</a>
<ol>
<li>When I ran mitmproxy for the first time, I got an error similar to &quot;MSVCP140.dll was not found&quot;. To mitigate this, I downloaded Microsoft Visual C++ 2015 - 2022 Redistributable x64 and it was resolved</li>
</ol>
</li>
<li>I downloaded the Obsidian software</li>
<li>In order to decrypt some SSL/TLS traffic, you need to <a href="https://docs.mitmproxy.org/stable/concepts-certificates/" target="_blank" rel="noopener noreferrer">install or import the CA certificate</a>. On Windows, this can be done by navigating to the files with an admin PowerShell terminal (for me was <code>C:\Users\vboxuser\.mitmproxy</code>) and then running the following: <code>certutil -addstore root mitmproxy-ca-cert.cer</code>.<!-- -->
<ol>
<li>NOTE: the <code>C:\Users\vboxuser\.mitmproxy</code> directory will be created after initial run of mitmproxy</li>
</ol>
</li>
<li>After installation, I located where the EXE for Obsidian was located<!-- -->
<ol>
<li>This can be done by right-clicking the shortcut, viewing its properties, and then seeing where it points to under &quot;Target:&quot;</li>
</ol>
</li>
<li>In the Obsidian EXE folder, I ran the following to attach mitmweb to the Obsidian.exe executable: <code>mitmweb --mode local:Obsidian.exe</code>
<ol>
<li><strong>I would recommend using <code>mitmweb --mode local</code> as an alternative as well, to make sure you don&#x27;t miss any subprocesses spawned or any network traffic</strong></li>
</ol>
</li>
<li>If done properly, you should be able to see traffic on the web portal (127.0.0.1:8080).</li>
<li>(Optional) Save the flows to reuse later for an investigation</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/Screenshot_2024-03-28_13-14_1.cleaned-09ca88a544fae7cc442c6a47733bc79b.png" width="1422" height="1091" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/Screenshot_2024-03-28_13-37.cleaned-1689c6e9a47decc2503bed57cac5ebb6.png" width="1275" height="998" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/Screenshot_2024-03-28_21-41.cleaned-1cf8daa2d28f883237c9baff3734b34e.png" width="634" height="774" class="img_ev3q"></p>
<p>While looking around, I did notice something interesting:</p>
<p><img decoding="async" loading="lazy" src="/assets/images/Screenshot_2024-03-28_20-10.cleaned-d697c2c5846e873e616e75bd21572687.png" width="629" height="371" class="img_ev3q"></p>
<p>To me it seems that Obsidian is tracking end users by assigning a desktop ID to each app. At first, I thought it was maybe assigned to the specific version of the app. When I followed the same steps as above again on a clean install, I got the following:</p>
<p><img decoding="async" loading="lazy" src="/assets/images/Screenshot_2024-03-28_20-36.cleaned-6374f44c3ee1df853a7f0443f67be9fc.png" width="635" height="368" class="img_ev3q"></p>
<p>It does seem like it is a generated ID for each application. Companies usually use IDs for telemetry and crash error analytics. However, I am not sure why there is an ID per application, since the version (&quot;v&quot;) and product (&quot;p&quot;) should be enough for them to provide an update or release. In addition, I did not see for a way to disable crash analytics in the app. I did not sign-in to the app, so perhaps my options were limited. My best guess for this is that maybe it is used to track in a masked way which applications are on what version and OS to gain insight from a corporate perspective.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>If my assumption is incorrect, please feel free to reach out and let me know why an ID is being used <strong>per application</strong> basis or if the ID is for something else completely.</p></div></div>
<p>Other than this, nothing notable stood out here either.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="static-analysis">Static Analysis<a href="#static-analysis" class="hash-link" aria-label="Direct link to Static Analysis" title="Direct link to Static Analysis">​</a></h2>
<p>Static Analysis allows us to see hard-coded strings in an application to gain insight into some of the items it calls on such as variables and IP Addresses.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ipv4-addresses">IPv4 Addresses<a href="#ipv4-addresses" class="hash-link" aria-label="Direct link to IPv4 Addresses" title="Direct link to IPv4 Addresses">​</a></h4>
<p>In order to check out the main executable, we have to &quot;unpack&quot; the AppImage file. This can be done by running <code>./Obsidian-1.5.8.AppImage --appimage-extract</code>[7] to extract the files. From there, we can see an executable titled &quot;obsidian&quot;. Since we know the main program is titled <code>obsidian</code>, we can then run <code>grep -ao -E &quot;(\b25[0-5]|\b2[0-4][0-9]|\b[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}&quot; obsidian</code> to grab all IPv4 addresses hard-coded into the program.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="urls">URLs<a href="#urls" class="hash-link" aria-label="Direct link to URLs" title="Direct link to URLs">​</a></h4>
<p>Running the <code>grep -ao -E &quot; https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9\(\)\!\@:%_\+.~#?&amp;\/\/=]*) &quot; obsidian</code> command, we can see all of the URLs in the file as well:</p>
<p><img decoding="async" loading="lazy" src="/assets/images/Obsidian_URLs.cleaned-cf73d4738479f52c82f31e3deb808de1.png" width="1655" height="779" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>Obsidian is already a well-known app for taking note-taking to the next level. I used Obsidian as a test to see what information I can gain from a closed-source app in order to be more informed about the application&#x27;s interactions. Based on the limited monitoring I did, I did not find anything of concern, thus being &quot;safe&quot; for me to use for now.</p>
<p>I set out to find ways to validate and investigate the applications I use on a daily basis. This does fall partially into the Malware Analysis topic, however, we are using the same tools for what we deem could be a threat to our privacy. I did learn a lot about namespaces and some other networking concepts. I do plan to do this for other apps going forward.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="credit">Credit<a href="#credit" class="hash-link" aria-label="Direct link to Credit" title="Direct link to Credit">​</a></h4>
<p>A huge thanks to Joshua Richards for allowing me to bounce this idea off of him and for reviewing this blog.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sources">Sources:<a href="#sources" class="hash-link" aria-label="Direct link to Sources:" title="Direct link to Sources:">​</a></h3>
<ol>
<li><a href="https://askubuntu.com/questions/11709/how-can-i-capture-network-traffic-of-a-single-process" target="_blank" rel="noopener noreferrer">https://askubuntu.com/questions/11709/how-can-i-capture-network-traffic-of-a-single-process</a></li>
<li><a href="https://blog.scottlowe.org/2013/09/04/introducing-linux-network-namespaces/" target="_blank" rel="noopener noreferrer">https://blog.scottlowe.org/2013/09/04/introducing-linux-network-namespaces/</a></li>
<li><a href="https://github.com/draios/sysdig/wiki" target="_blank" rel="noopener noreferrer">https://github.com/draios/sysdig/wiki</a></li>
<li><a href="https://github.com/draios/sysdig/wiki/Sysdig-Examples" target="_blank" rel="noopener noreferrer">https://github.com/draios/sysdig/wiki/Sysdig-Examples</a></li>
<li><a href="https://docs.mitmproxy.org/stable/howto-transparent/" target="_blank" rel="noopener noreferrer">https://docs.mitmproxy.org/stable/howto-transparent/</a></li>
<li><a href="https://docs.mitmproxy.org/stable/concepts-certificates/" target="_blank" rel="noopener noreferrer">https://docs.mitmproxy.org/stable/concepts-certificates/</a></li>
<li><a href="https://superuser.com/a/1389548" target="_blank" rel="noopener noreferrer">https://superuser.com/a/1389548</a></li>
<li><a href="https://ihateregex.io/expr/ip/" target="_blank" rel="noopener noreferrer">https://ihateregex.io/expr/ip/</a></li>
<li><a href="https://ihateregex.io/expr/url/" target="_blank" rel="noopener noreferrer">https://ihateregex.io/expr/url/</a></li>
</ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/category/operations-security-opsec"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Operations Security (OPSEC)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/operations-security/application-sandboxing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Application Sandboxing</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tools" class="table-of-contents__link toc-highlight">Tools</a></li><li><a href="#behavioral-analysis" class="table-of-contents__link toc-highlight">Behavioral Analysis</a><ul><li><a href="#network-connections-via-an-isolated-network-namespace" class="table-of-contents__link toc-highlight">Network Connections via an Isolated Network Namespace</a></li><li><a href="#system-interactions-via-isolated-network-namespace" class="table-of-contents__link toc-highlight">System Interactions via Isolated Network Namespace</a></li><li><a href="#man-in-the-middle" class="table-of-contents__link toc-highlight">Man-in-the-middle</a></li></ul></li><li><a href="#static-analysis" class="table-of-contents__link toc-highlight">Static Analysis</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a><ul><li><a href="#sources" class="table-of-contents__link toc-highlight">Sources:</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright"> <p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="http://www.harisqazi.com">Portfolio</a> by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="http://www.harisqazi.com">Haris Qazi</a> is licensed under <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">Creative Commons Attribution 4.0 International<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg" alt=""></a></p> </div></div></div></footer></div>
</body>
</html>